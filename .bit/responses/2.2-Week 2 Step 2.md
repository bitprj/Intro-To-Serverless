---
files: n/a
stepType: IssueComment
scripts: n/a
week: 2
step: 2
name: Week 2 Step 2
---

## Week 2 Step 2
### Checkpoint #1

> Congrats! You've made it to the first checkpoint. We're going to make sure your Azure Function can complete its first task: **parsing the image.**

1. In order to make sure your function is correctly receiving and parsing the image, we are going to be adding a line of code in the module.exports function to **print out the image data in our Azure console.**

*Hint: take a look at the ```var parts...``` line*

<details>
<summary>Need an explanation?</summary>
<br>

* Use context.log() to print to console
* Our last line of code, `var parts = multipart.Parse(body, boundary);`, stored our parsed image...
* We only have one image, so let's access it in the array with the index of 0: `parts[0]`

Final line of code: `context.log(parts[0]);`

</details>

2. Let's use our **Postman** skills to make a **POST request to the Azure Function.**

* Navigate back to the Postman Chrome extension app and change GET to POST
![Untitled_ Nov 11, 2020 6_24 PM](https://user-images.githubusercontent.com/69332964/98876201-c3bca780-244b-11eb-9b94-8d3cecc80115.gif)

* Copy your function's url from the Azure Function App portal like this:
![copy function url](https://user-images.githubusercontent.com/69332964/98876502-6f65f780-244c-11eb-832b-a25888b980da.gif)

* Use the function url and any image you want to send the POST request. By default, the request is going to be in the form of a "Param" and you want to change this to "Body" > "form-data". Remember to attach the file in Body! You will need to add the name of the file (e.g. "image") in Key and upload the image in "Value". You can add a description if you'd like but this is not entirely necessary.
![postman](https://user-images.githubusercontent.com/69332964/98876997-780afd80-244d-11eb-87fc-13822d909f2f.gif)

* When you hit send to send the request, make sure to have your Function open in another tab to observe what happens. You should get something like this:
![console response](https://user-images.githubusercontent.com/69332964/98876407-3c236880-244c-11eb-9965-afed1085debb.png)

Remember, we are using Postman to test the request before we go ahead and create the website that will allow us to upload an image and make the request. If you come across any errors here, make sure to debug them (Google is a great resource) before moving forwards.








# parse multi-part

- [ ] Install the `parse-multipart` package npm package on the Azure portal Console
    * [What is the parse-multipart package?](https://www.npmjs.com/package/parse-multipart)


![flowchart](https://user-images.githubusercontent.com/69332964/103604140-3e4ef400-4ede-11eb-8b0e-f3b6b3f203b7.png)

<details>
<summary>❓ What is happening in the flowchart?</summary>

* **HTML Page:** Where the user will submit an image; this page will also make a request with the image to the Azure Function.
* **Azure Function:** Receives the request from HTML Page with the image. In order to receive it, **we must parse the image...**
</details>

<details>
<summary>❓ What does "parsing" mean?</summary>

[Parsing](https://oxylabs.io/blog/what-is-data-parser) is the process of analyzing some data (sequence of characters) in order to convert it into another data type (interpreting data from one type to another).
</details>

<details>
<summary>❓ What does "multipart" mean?</summary>

In any HTML `<form>` element that receives involves a file upload (which ours does), the data is encoded in the `multipart/form-data` method. 

The default http encoding method is `application/x-www-form-urlencoded`, which encodes text into name/value pairs and works for text inputs, but it is inefficient for files or binary inputs. 

`multipart/form-data` indicates that one or more files are being inputted. Parsing this type of data is a little more complicated than usual. To simplify the process, we're going to use an npm library called `parse-multipart`.  
</details>

<details>
<summary>❓ How do I install parse-multipart?</summary>
</br>

To import Node packages, we use the `require` function:

```js
var multipart = require("parse-multipart");
```

This imports the `parse-multipart`  package into our code, and we can now call any function in the package using `multipart.Function()`. 

Your function should look like this:

```js
var multipart = require("parse-multipart");

module.exports = async function (context, req) {
    context.log('JavaScript HTTP trigger function processed a request.'); 
};
 
```
</details>

<details>
<summary>❓ What data is needed to parse the image?</summary>
</br>

Go to https://www.npmjs.com/package/parse-multipart for documentation and context on what the package does.  Look specifically at the example in the "Usage" section and what they are doing, as we're going to do something similar.

Notice that `multipart.Parse(body, boundary)`  requires two parameters.  I've already gotten the boundary for you – just like the documentation example, our boundary is a string in the format `"----WebKitFormBoundary(random characters here)"`.

In the `multipart.Parse()` call, you need to figure out what the body parameter should be.

Hint: It should be the request body. Think about the example Azure function. How did we access that?

```js

//here's your boundary:
var boundary = multipart.getBoundary(req.headers['content-type']);
  
// TODO: assign the body variable the correct value
var body = '<WHAT GOES HERE?>'

// parse the body
var parts = multipart.Parse(body, boundary);
```
</details>