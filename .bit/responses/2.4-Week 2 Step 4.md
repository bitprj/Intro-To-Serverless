---
files: index.js
stepType: PRmerge
scripts: n/a
week: 2
step: 4
name: Week 2 Step 4
---

Week 2 Step 4 â¬¤â¬¤â¬¤â¬¤â—¯â—¯â—¯ | ðŸ• Estimated completion: 5-20 minutes

### âœ… Task:
**Modify your Azure Function so that it returns the dominant emotion of an image.**
- [ ] In your function `emotionalgifs`, determine the dominant emotion in the emotion data
- [ ] Output the dominant emotion when you make a `POST` request
- [ ] Commit your code to `week2/emotional.js`

## Finding the dominant emotion
In the next few steps, we are going to **connect** our current Azure function and the **Giphy API**. We will match the dominant emotion of an inputted image with a gif. First, we need to find the **dominant emotion** in the returned emotion data.

### :hammer_and_wrench: Modifying the Azure function
We need to access the emotion data **by itself**, without the face id and other analyzed data. To do this, we need to create **another variable** in the first async function in our Azure Function:

```js
let emotions = result[0].faceAttributes.emotion;
```

We're accessing the data at index 0 because we're analyzing **one face**. If there were two faces, the data for the second face would be stored at index 1.

Next, we need to **convert** the object containing the emotion data into an **array** so that we can manipulate it and find the dominant emotion. `Object.values()` converts an object into an array, with each value in the object stored as a separate element:

```js
let objects = Object.values(emotions);
```
Finally, we need to find the dominant emotion in the array `objects`:

```js
const main_emotion = Object.keys(emotions).find(key => emotions[key] === Math.max(...objects));
```
Now, `main_emotion` contains the dominant emotion! All we need to do is output `main_emotion` when the function is called:

```js
context.res = {
        // status: 200, /* Defaults to 200 */
        body: main_emotion
};
```
