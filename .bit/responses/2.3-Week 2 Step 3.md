---
files: n/a
stepType: checks
scripts: test.secrets2.js
week: 2
step: 3
name: Week 2 Step 3
---

Week 2 Step 3 ‚¨§‚¨§‚¨§‚óØ‚óØ‚óØ‚óØ‚óØ | üïê Estimated completion: 10-15 minutes

## Gifs and More Gifs with Giphy API
You will be working with the Giphy API to return a GIF instead of a json file of emotion data. Why? Cause GIFS are fun. 


### ‚úÖ  Task:

- [ ]  Run `git pull` 
- [ ]  Make sure you are in the `week2` branch 
- [ ]  Create a Giphy API Key
- [ ]  Save your API key as an **environment variable**
- [ ]  Using `node-fetch`, modify your `emotional.js` function to return the results from the Giphy translate endpoint
- [ ] Commit your code to `week2/emotional.js`

## Huh? Giphy API?
<img src="https://media3.giphy.com/media/fGOn4fZoBY97P3zIEm/200.webp?cid=ecf05e47q6ybkb9n15v73n3vavswq1dlp3naj9fo2u9lgmid&rid=200.webp&ct=g" height="250">

**Giphy** is a database for finding and sharing animated GIFs. We are going to use their API. Our HTTP trigger function will call the Giphy API using the emotion data we recieved. Then, the Giphy API will find a GIF that matches the dominant emotion of the subject in the analyzed picture.

- To set up an account, go [here](https://giphy.com/join) and enter an **email address, username,** and **password**.

- To find the documentation, go [here](https://developers.giphy.com/docs/api/endpoint#translate). The link (for gifs) that is listed there is the endpoint we will be using in this project.

<details>
<summary>:question: How do I create a Giphy API key?</summary>
</br>

To create an **API key**, click [here](https://developers.giphy.com/dashboard/) and click Create an App. <br>
<img width="352" alt="Screen Shot 2021-04-15 at 5 55 16 PM" src="https://user-images.githubusercontent.com/70852990/114943343-d892d200-9e13-11eb-9365-9f6aec7692c3.png">

Select API, **not** SDK! <br>
<img width="663" alt="Screen Shot 2021-04-15 at 5 55 32 PM" src="https://user-images.githubusercontent.com/70852990/114943349-daf52c00-9e13-11eb-870e-0be1998c2e04.png">

Then, enter the required information. <br>
<img width="663" alt="Screen Shot 2021-04-15 at 5 55 41 PM" src="https://user-images.githubusercontent.com/70852990/114943355-dd578600-9e13-11eb-8257-1d9b65f8f5f1.png">

<br>
Finally, click Create App, and your key should be given!

<br><br/>
</details>

## Calling in the Giphy API
<img src="https://media0.giphy.com/media/833TXYqnMw7Go/200w.webp?cid=ecf05e47z1r1e1ax62zp68eeex57a9bt7vwowretds1ue128&rid=200w.webp&ct=g" height="250">

GIPHY Translate converts words and phrases to the perfect GIF or Sticker using GIPHY's special sauce algorithm. For example, the word `beard` gets converted to this masterpiece 

Make sure you edit your `emotional.js` function to call the Giphy API and translate the results from the Face API for a gif that matches the dominant emotion from your emotion data.

Don't forget to have fun with the API ‚Äì customize your call using the different parameters. Remember to use the gif and not the sticker endpoint!

<details>
<summary>:exclamation: Can I get a more detailed list of steps?</summary>
  </br>
  
1. In the **async function**, create a new constant that will recieve the dominant emotion from your emotion data (i.e. angry, happy). This dominant emotion should be determined before you call on the trigger function.
2. Using **node-fetch**, call the Giphy **translate endpoint** from the documentation.
3. Run the constant through the **string** parameter in the endpoint (look as the documentation if this sounds confusing). Add your **Giphy API key**, and set the number of returned gifs to 1 by adding `&limit=1` to the endpoint.
4. Declare another constant that formats the results of the API call in **json** format.
5. Make this second constant the **output** of the function in `context.res`.

  <br><br/>
  
</details>

<details>
<summary>:exclamation: I'm stuck. Can I get some hints?</summary>
  </br>
  
Fill in the gaps:
  
```js

module.exports = async function (context, req) {
    context.log(‚ÄòJavaScript HTTP trigger function processed a request.‚Äò);
    const phone = (req.query.phone || (req.body && req.body.phone));
    
    const emotion = (FILL_THIS_IN);
    
    const apiResult = await fetch (‚ÄúENDPOINT_GOES_HERE");
    const jsonResult = await ADD_CODE.json();
    
    context.res = {
        // status: 200, /* Defaults to 200 */
        body: jsonResult.data.images.downsized_large.url
    };
    
 ```

  <br><br/>
  
</details>

